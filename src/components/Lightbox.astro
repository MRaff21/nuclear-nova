---
const { src, alt } = Astro.props;
---

<div class="lightbox" id="lightbox" hidden>
  <div class="overlay"></div>
  <img src={src} alt={alt} />
</div>

<script>
  const lightbox = document.getElementById("lightbox");
  const img = lightbox.querySelector("img");

  document.addEventListener("click", (e) => {
    if (e.target.matches("[data-lightbox]")) {
      img.src = e.target.src;
      lightbox.hidden = false;

      // allow DOM to paint before animating
      requestAnimationFrame(() => {
        lightbox.classList.add("open");
      });
    }

    if (e.target.classList.contains("overlay")) {
      close();
    }
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape") close();
  });

  function close() {
    lightbox.classList.remove("open");

    setTimeout(() => {
      lightbox.hidden = true;
    }, 300);
  }
</script>



<style>
  .lightbox img {
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  z-index: 500;           
  max-width: 90vw;
  max-height: 90vh;
  border-radius: 6px;

  /* animation start state */
  transform: translateY(0) scale(0.95);
  opacity: 2;

  transition:
    transform 300ms cubic-bezier(0.22, 1, 0.36, 1),
    opacity 200ms ease;
}

  .overlay {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.8);
    opacity: 0;
    transition: opacity 250ms ease;
  }

  .lightbox.open .overlay {
    opacity: 1;
  }

  .lightbox.open img {
    transform: translateY(0) scale(1);
    opacity: 1;
  }
</style>

